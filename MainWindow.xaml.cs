using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Media.Media3D;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace Cubing
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        CubeWorld cw;
        Cube c ;
        Cube3D c3d;
        int currentMoveID = 0;
        string[] moves = new string[0];
        bool autoMoving = false;
        Rotation currentRotation;

        public MainWindow()
        {
            InitializeComponent();
            cw = new CubeWorld(myViewport3D, this);
        }

        private void btnCreateByDimension_Click(object sender, RoutedEventArgs e)
        {

            c = new Cube(Convert.ToInt32(textboxDimension.Text));
            c3d = new Cube3D(c);
            cw.Cube3D = c3d;
            c3d.AnimationCompleted += C3d_AnimationCompleted;
            ShowWholeCube();
        }

        private void btnRandom_Click(object sender, RoutedEventArgs e)
        {
            int dim = Convert.ToInt32(textboxDimension.Text);
            int depth = dim * dim * 3;
            Scrambler s = new Scrambler(dim, depth);
            c = new Cube(dim);
            for (int i = 0; i < s.Moves.Length; i++)
            {
                c.Move(s.Moves[i]);
            }
            textboxCubeString.Text = c.CubeString;
            textboxMoves.Text = "";

            c = new Cube(textboxCubeString.Text.Trim());
            c3d = new Cube3D(c);
            cw.Cube3D = c3d;
            c3d.AnimationCompleted += C3d_AnimationCompleted;
            ShowWholeCube();

        }

        public delegate void UpdateSolutionText( string sol);
        private Cursor cursor;
        private void Cs_SolutionFound(CubeSolver sender, string sol)
        {
            sender.SolutionFound -= Cs_SolutionFound;
            textboxMoves.Dispatcher.Invoke(new UpdateSolutionText((s) => {
                textboxMoves.Text = s;
                this.Cursor = cursor;
                MessageBox.Show("Solution Found!");
            }), sol);
        }

        private void btnGetSolution_Click(object sender, RoutedEventArgs e)
        {
            CubeSolver cs = new CubeSolver();
            cs.SolutionFound += Cs_SolutionFound;
            cs.BeginFind(c.CubeString);
            cursor = this.Cursor;
            this.Cursor = Cursors.Wait;
        }

        private void btnDemo_Click(object sender, RoutedEventArgs e)
        {
            //for test
            string[] democubes = new string[]
            {
                "",
                //1x1x1
                "URFDLB",
                //2x2x2
                "DLRRFULLDUBFDURDBFBRBLFU",
                //3x3x3
                "RRBBUFBFBRLRRRFRDDURUBFBBRFLUDUDFLLFFLLLLDFBDDDUUBDLUU",
                //4x4x4
                "FLDFDLBDFBLFFRRBDRFRRURBRDUBBDLURUDRRBFFBDLUBLUULUFRRFBLDDUULBDBDFLDBLUBFRFUFBDDUBFLLRFLURDULLRU",
                //5x5x5
                "LLFBRBFUDULBULBBDDUBBBBLDFDULDLURFBDFRLDUFDBRLDUFBLURFRFRDRBULFBLLLBURUFRFURDDLBULLLRLRDFRDRBBRUDFDUFRBUDULFDUFULDFRBRBULLUFFBLRDDDDFRRBUBRLBUUFFRRDFF",
                //6x6x6
                "FBDDDFFUDRFBBLFLLURLDLLUFBLRFDUFLBLLFBFLRRBBFDRRDUBUFRBUBRDLUBFDRLBBRLRUFLBRBDUDFFFDBLUDBBLRDFUUDLBBBRRDRUDLBLDFRUDLLFFUUBFBUUFDLRUDUDBRRBBUFFDRRRDBULRRURULFDBRRULDDRUUULBLLFDFRRFDURFFLDUUBRUFDRFUBLDFULFBFDDUDLBLLRBL",
                //7x7x7
                "DBDBDDFBDDLUBDLFRFRBRLLDUFFDUFRBRDFDRUFDFDRDBDBULDBDBDBUFBUFFFULLFLDURRBBRRBRLFUUUDUURBRDUUURFFFLRFLRLDLBUFRLDLDFLLFBDFUFRFFUUUFURDRFULBRFURRBUDDRBDLLRLDLLDLUURFRFBUBURBRUDBDDLRBULBULUBDBBUDRBLFFBLRBURRUFULBRLFDUFDDBULBRLBUFULUDDLLDFRDRDBBFBUBBFLFFRRUFFRLRRDRULLLFRLFULBLLBBBLDFDBRBFDULLULRFDBR",
                //8x8x8
                "DRRRURBDDBFBRBDDBRRDUFLLURFBFLFURLFLFRBRFUBDRFDFUUBLFFFUULBBFDBDFBUBBFRFLRDLFDRBBLLFRLDFDRBURULDDRFFBFUUBLLFBRUUFDUBRDBBRDFLURUUFFUDLBRRFDUBFLRUUFFRLBFRFLRULUDFRUBBDBFFLBBDFDFLDBFRRRDDLFLBRBFBBRULDDUUBLBBURULLDDLDRUDRBUDRLUULDURLRDFLFULUFLFULRDDDUBBULRBRDFBBLFURRLULUBDDULRFBRFURBRLBRUBULBDDFBUFFBBRLRUUUFRULLBFFRFDDFFDULLDLBUDLLLLUUBBLDLLBBULULBDUDDFUBFLLDLDLFRDUDDBRRFRURRFRRLDDDDRD",
                //9x9x9
                "RFBLRUFLLFFLRRBDUDDBBBDUDFRUDUFFFBBFRBRDURBULFUDDFLLLDLFLRDLDBBBUUBRDBBBDFUFRUURULURBURDLFDUBFFDRDFRUBDUBRFLRRLUDLRLFBLBRRLLRDRBRBLURBLLRFRLDDFFFRBFUFURDFRRUDUFDDRRRLFLLUBBLBFDRRDLBRLUUBRDBBUBFLUUFBLLDBFFFBUFBFDBRDDDFLRFFBFFFLFRRDUUDDBUBLUUDURRBDBFFLFURDDLUBULUULULBFBRUBLLDDFLRBDBRFDUUDFURLLUBUFBLULLURDLLLBLFFRLLBLUDRLRDBLDDBRBUDRBLLRDUUUBRRFBFBBULUDUDLDRFUDDDFULRFRBDUDULBRRDBDFFRUUFRRFBDBLFBBDFURLRFDUUFRLUBURFURDDFLDFUBDFRRURRDLUDRBRBDLBFLBBRDLRDBFDUBDFFUBLFLUULLBUDLLLURDBLFFFDFLF",
                //10x10x10
                "ULBDLDBUFRBBBBBLBFFFDFRFBBDDFDFRFFLDLDLURRBUDRRBFLUDFRLBDURULRUUDBBBUBRURRRLDLRFFUFFFURRFBLLRRFLFUDBDRRDFULLLURFBFUUBDBBDBFLFDFUUFDUBRLUFDBLRFLUDUFBFDULDFRUBLBBBUBRRDBDDDDFURFLRDBRRLLRFUFLRDFDUULRRDULFDUDRFLBFRLDUDBDFLDBDUFULULLLBUUFDFFDBBBRBRLFLUFLFUFFRLLLFLBUDRRFDDUDLFLBRDULFLBLLULFLDLUULBUDRDFLUDDLLRBLUBBRFRRLDRDUUFLDDFUFLBDBBLBURBBRRRFUBLBRBRUBFFDBBBBLBUFBLURBLDRFLFBUDDFFRFFRLBDBDUURBUFBDFFFLFBDLDUFFBRDLBRLRLBFRUUUULRRBDBRRFDLLRRUUBDBDBFDLRDDBRUUUUUBLLURBDFUFLLRDBLRRBBLBDDBBFUDUDLDLUFDDDUURBFUFRRBLLURDDRURRURLBLDRFRUFBDRULUFFDUDLBBUURFDUDBLRRUDFRLLDULFUBFDLURFBFULFLRRRRRFDDDLFDDRUFRRLBLUBU",
                //11x11x11
                "URBDLBURUBUFDDRBUFDDUBFRDBLRFUUBLDRLBBUBLUFBLRBFFDDLLLDRULRBUDBBRLULBUUUFFRUBLUFUUBRLBLUUDRLDUBLUFDLBLFDBLFRLFLRUDFLLLDFULDRFDFLLFLLRDUUDRFRFFFFBFRBFRFUUBBUULURLULBBLLDDLBUFRURBLFFBRFFRRURFUFLLRUFDBDDDBLRDUBLBRBLRLBUBULLBBFRBFRBLFUDDULLFBRLDUFBBLDBBFBDBDUFFRRDBUUULDDBRFRDBDDRDRFUDBBFULDLUDBLRRFDBLDBLRFFBDLRBUBLDLUDFUFBDDRUDRDFUBLFFRBDFDDDBULBDRBUDBBDRLUFUFFFFDRBDLRLRDRRBFRLUBFFURFRLRLRRLDBLFLFULBURULDURURBLUFUULFBFULULUDLFLLUFLRFLRLFFDRBLLFRDDDBFBFFBLULDLRUDUURLRUFDRFRDURDUFFFULRRUURUDFURBDLBLLDFBBRDRLUBULFRDLRUFUFDBBDLRRURFULBBBBDBRUDUUULFFBUDLRUBRDDRBFDDBURRLURRDDRRRUURURFUBRRBFRFFFBLBLLDURBDRDFDFRRDRDDLDUFUFFLBDLBBDFLLLFDULDBLDRUUFDURBDLUBBLBDDFFDUURBLDRBRLDBLUDRLRFBFDUFUUBFBRDRFFFFUDDDRFFLDFLRRBLDRRDRFBFBLUDBFBBB",
                //12x12x12
                "RBBFDFFURLDLUURRRDDLDRDFFUDRRRRUBFRLRBLRULLBDFFDDLUULFFURRDBUUFRUUUBBDBBUUFRUUUBBDBBFUFUDRRBFLBBULBBFFFUBUFUULRRDRRLBFFFLFRDUFFDBBFFBLBFRRRLFLURDRUFRLLUBULDDDUDFDDDRULDRDFDRDDLLUURULBLRFFLUBUBURUFBRRURLFBRRDDURRBULFRRRDDURRBULFRDFUFDDDLUFLLLBUBDDDFLRLRFDDLRRRBDBUDDRUBDRRLDURFLLRFRFFLLFBFLBRRBFFDLBRFRLBRUBBFDFUFLLUUDUUBDRRULLBDRBBRUDRRLURBRUUUBBFRLRFRLFFUBLBBLRFRLFFUBLBBLLRLFRRRDFUFDFDFUDDBFFDUBDRBBUUUULFUDUBLFLLDLFDRFUBDRUUUDFUULFDRURRBLLBBDBBLBLLDRBBUFFBLLBBBUDLDBUDRDFFDULDUDBLRFLLRDDUDULURLDDFFBDLULURLDDFFBDLRDUFLBBBLBRFBFFRUUULLDUDDFBFDRRDFUDRLULBBBBLLLLURBDRBBBDBBRRULRFBBBRBBDDFFBDRRRBFRDFDLLLFDDFDDUDBRFFFRRBURUUDFURRDDUDURUFDBLDLLRLBLDFDBLDLLRLBLDULBUBFFLFRUULBRLLUUBBUFFBDLRFFFLRLLRDFBBLUUBBDLFDBFUFLLRRLRUFBUDFUULDDRBBBLUBUUDUDRLURBBDLLDLUFLLURDLDDBDURLLRDRDDDDDBUFDUUBFBBBLFFDDUUBFBBBLFFDFBFBFLLFDLRFBFLFLUULRUFFFFFFRLLFFRDUURBRFFFRURBLUULDBDDLURRB",
                //13x13x13
                "LLBBUUUUBFLRFBFBFBBBBBURULUBURRDDDDBFRFRRURFDDDBUURBFLLDFUUUUDBRULUULBUUUDBUFFLUULBUUUDBUFFLUULBUUUDBUFFDBLLUBBBRBLLRRDBFRUUUFURBUDUFLBUUUBDLUBDULDUUUUDBUBRULUBDBBBLFRRRDFLLDLLLLDUDLBLFRFFFFRLRLURLDDULLLUFBLRFLLBBBBBLDUUBBFLBDUUURRFDBDFDFDRRRUBRRUDFDFDRRRUBRRUDFDFDRRRUBRRUUDDLULLLBFDFLFFFDFRRRRBDLLDLFFUFFFFURURRLUFDUUUBLRDURDDDUBBBRDDDLLBBURRRRDUDUFRUFBRRRRUBUUUFFULLRRRBDFLDUFUUUDDDRRDURRBDDDRRRRLLUURDLLRFFFRFFDFRDLLRFFFRFFDFRDLLRFFFRFFDFLUDFLDDDRLDFFDLLFFFFFDLUURRBULULLLRBDDLDRRBDUUUFBULBUDRLDFFFRLUFDBBFDFUUUUDLDBBBRBRLLLFDBFRDRBBBDDDBRRFFDLFBBLLLBLRDFRRRULFFFFRLLBBDFRLDDDDRLBDBDFRLDDDDRLBDBDFRLDDDDRLBDBLUBLBBBDRFLBFLLDRBBBLUDDFUDLRFBBBDFUDBFDFRUBBBDDDRLFLFBLUUULUFRFDDRURDDDFBFFBFRBFLFFFRDLBBRFRBBBBBRBRLLRFURURRRLFRDRUBBFDLLLFDDFFRRBUBLLLLUDLDRRBUBLLLLUDLDRRBUBLLLLUDLDLUFDBUUUBDLBUDRDLUDDDUDBUBLDBDFUUUUFLDFLFBRULLLFUUDRRUBLDLLLBRLLRDUBLDRRRRLDFBLBRLRDDDRRDDUBBDRRFFFUBDBBUULFFDDDLBFUBLDFDBFFFFBRBFLBRLFBBBRFRRFLBRLFBBBRFRRFLBRLFBBBRFRRFDLURUFFFLURLFURLLUUUUURFBRUDBRRBBBFULFUBRLFDLLLUFFFUUFLFBBBBFLUFU",
                //14x14x14
                "FBDRLBLRRURRLDRBDLBURDFDDDRBLBBFBRDLLFDUBLFRLDFUUBFRDBFBBBULFRLBUFLBDDDLLDRBFLLBBLFBFFDFBFDDFRRRBDRRBRBDUFDRLRUDLDFDDURFLBUBBUUDLBRRDUDRDBBBLDBRBBBUFLBLRUURBDDLDRLUFFBLFRLDFBRFLDLBULFFBRLDBDDFLLRFLUBFDFBRLRLFDBLBURLBLFRFBLLDULUDURLBUUULLRRLUBDDLURLLRFURFRFRBDDUBLDFBLUDRLRDRRBLFUFRDUFFRULBLRBBRUFDBUBBBBLDBRBLDDRRFDDBFFUUBRBLFUBBRFUURBFDRLURLRBFUUFUBRUDRBDFBBFURFLFFDRDFUFFULFLUBDFUFFDLRRFRUDUDLBBBDLLLDUFUDRFDBLRRFFLRUFDRFURDLRRDRDLFBRLRLULRFBDLFDRLFRDDFLLDBFBUBBRLLDLFURFRFULUBLUBFLFFBFDFBDUUBURUUUBFUBDLLFLUUUFDUDLUUULDLLUDDBUFRDRULRLLULRULFBLUDFURFLFUBDLLFLFUBUUBBUFLUDUBRDBLFFUUUFDRLRULUDDRLRBLRUUFBRRRRULBDLFBFLDLRDFUBLUBRDDFUULFLDLUBFURRURUBDFFFDLRFFLBRFRDRUDUULURULLDFRBUDRDLFUFULDBLUBFRFBURDLLUUFDURLRDBLFFRFDBFURLFUBLUUUFFRULUBURRURFDDBFUFRBURBBDRFUDDFDLRUURFBBDBDRLUBRRBFDFRDFDLRDUFFUBRRBDBBLDLFDUDDRLFRRRBUUUBRFUFBUFFBRRDRDDBBDRUULDRFRFBUFLFFBLRBFLLLRUDFDRUDLDRLFRLUFLUBRDUFDDLLUDDRBUBBBDRDBBFRBDDRRLRRUUBBUDUDBLDBDFLFRFUBFLFDBBLRLULDBRFBRRLUUURDFFFDBLDUDBRFDDFFUBLUUURBBULFUFUDFBRDLLFURBULULBUDLUFFBDRBRRDBUUULFDURRDFDDLUDBDRBFBUFLULURUFDRFRFBBFBBBDRLBLUDLDRDLLDRRLLDLFBRBRLDUFBDDUDBLDFRFBBBDRDRDDLDRULFFLLFLBLDFLURLBUDFBDLRBLFDFLUDDFUBUBLURBBBLFRLFLBDDBURFFBFRRL",
                //15x15x15
                "RLURLURBDDULFUUURFLRBLURUBFDBULFLUBBFLDUFBDRFRBRUDFULFRUFLUDFRLFDFLLFDBULURRLBFBUURDULFDFBLRRRLFULLFFFDUULRRRUUUUFDBLDDFFLRDLLUURUBBULUFFURBRRLBBUUBBFDRRBRBRLUDLUDRBFBFULLRRBBFBFRDDDLDDDFRFUFLURUFLBDLUBRLDFRRDBDBFLFUDFLDFFURLFULLDDRURRDLRFLDFLULUUDDRFDRBLRBRBFUFDBDUUDBRRBDFBLBLRBBLBFLLDUBFFFFBDDRLBBBRFDFFUBBDURFLUUDDDRDDLDBRLBULLFLFBRBRBLUDDLRDRDUDFLFRUFLDLBLURDDDRUFDLBRDRLFBDBLDRFBFFBURULUDRRBRDFRFFLULLUBRDRRRDUFRBLFULUBBUFFBRBBFRLFDRRDBLDFRDRDDRLRUULBDURDURFDDLFDUUDBFLBDUFBULFRRDUDUBFBUDBBFUDFUUDLUDDRFDDDFRRRBUDRBFBBULLUFBLRLFLLBRRRRUBDRFLFDFDBLRFLURULULFFBUUUUFDBBLDLUBBRUBBBRBFLULLBLUUULLUBFFDULDFFBFFFUFFDUDRFBUFLDDLURFLRFLRFBUUBLRFDDRULUUUFFRDDBLRDULFURUDDBDLBBUUBFURFRFBRLBUULBLDDDBUBRFFULLUDFFDLDFUBLLBLDFFDDLBDUFUFFLBBBUBULDDFBRRFFLDUDDFRBLRRDDUDLBDBLURBUDBRRLUBBDRFBUFRDRDRBBDULBUFFDRBBDFBUULFFRLLDURRRDFFUUFULDULURLDLUUUDLBBUDLDRFBDBBDLUFBRRFDFLLDLFDBRBBRFUDDDBURDRBUBRUBDUBLDLLDLURLDFDBRUBDLDFRRRBRLULFRFLDRLBUBRUBLFBFDFFLFRFDFLBRULLRBLDRBBFURRRDUUULLULLDLBLBBDFBUUUBRRUFFBRUDBFRDFDLFLFFRFFFFRULDFFDFRUBBBRURBUFLBDFBBBBBRRRLFLFBDRRUFLURDDLRRBRLLFURRURBRFLLLFFURBFULFRFFBLDUUUUBDDUFFDRBRLDDFRBULDDDFFRURUFLDRFLDFBLRUFFUBBDFFDBLLDBDUBDLDLUDFBFLRULRRBDBLRBLDLUURRLLRULDBLBLLRRFDDRBBRBUBDDULDRFBFBBFLUFBLUULDDFDBRLLUBUBBDFBBLBBUBLULDRUDBLRULDUDLUFRRDLLUDDBUFLFLBUFUURFDRDLBURLLRRRULRBFFRRBRFBUBRBUUFRLRDRDLBBRFLLLDDBRFUFRBULFLFDRDDRRDBF",
            };
            string[] demosols = new string[]
            {
                "",
                //1x1x1
                "",
                //2x2x2
                "U R' F U' F2 R F' U' F",
                //3x3x3
                "U2 B R' F' D B R L' D' R' F' R2 U' B2 R2 U' D' F2 R2 U' B2",
                //4x4x4
                "Dw Bw2 D' L Rw' Dw' L Dw2 Rw F2 U2 D Dw2 B' Rw' Rw2 F' Uw2 D' Bw2 D B Uw2 B2 D' B2 U2 R2 Bw2 U R2 D' Bw2 R' U' D2 B' D R2 F' R2 L2 U' L F2 D2 F2 B2 L2 D' L2 B2 D2",
                //5x5x5
                "D2 Rw' D2 Fw Rw' B Uw' Lw' D Dw Bw' Rw' D Lw Uw2 Rw U' F' B' Lw B Rw' L Uw2 Rw2 F2 U' Lw2 F' L' Lw2 U' L2 F' D2 Fw2 L2 F D2 Lw2 B Uw2 Rw2 D2 B' Dw2 Bw2 D' Rw2 Fw2 Lw2 D' F2 L2 D Bw2 D B2 Lw2 R2 U Bw2 R2 U' D L' B U2 R' D F U' B L2 U D2 L2 F2 U' R2 B2 U' F2",
                //6x6x6
                "R' Rw' Fw U' 3Bw Rw2 3Dw' R 3Dw' Rw' U2 F Uw2 Lw D Fw L' Dw' Dw2 B 3Rw' 3Dw2 B2 Lw 3Rw' F' Dw2 3Lw' Rw U' F Uw2 D Rw Fw2 B Rw' Dw2 3Bw2 Uw2 R' 3Uw2 D R' Dw2 B2 3Rw2 Fw2 U F' Rw2 D Lw2 F 3Lw2 D2 Bw2 Uw2 F 3Fw2 L2 U' F 3Lw2 3Dw2 3Lw2 D R2 D' R2 3Bw2 R2 U' D2 3Bw2 D B2 2Lw2 D 2Rw2 U' F' L' F2 D' U2 2Uw2 F' 2Lw2 2Uw2 2Rw2 2Fw2 2Uw2 L2 B' 2Dw2 B' 2Uw2 D F2 U R2 F2 2Bw2 U B2 D2 2Rw2 2Bw2 2Rw2 F2 2Rw2 D' 2Bw2 U B' L2 U F2 L' B2 U2 B L2 B' R' D R2 U R2 B2 L2 U' F2 R2 D2",
                //7x7x7
                "3Dw2 3Rw D' 3Fw' 3Uw' 3Dw 3Lw2 F' 3Lw' 3Rw2 3Dw' D2 3Rw Fw' 3Dw2 3Rw' Bw' 3Lw Bw 3Lw Rw2 Uw' 3Rw' Dw2 B Dw Rw' Bw' U' Uw' Dw2 L' Fw' Dw' 3Lw 3Rw U D 3Lw' F' 3Fw2 B D 3Rw' 3Dw2 Fw2 B Rw' 3Fw2 U' 3Fw2 D 3Lw2 D2 Lw' Uw2 Rw F Rw Fw2 D Lw' 3Dw2 Bw2 3Rw2 3Dw2 R' 3Fw2 Uw2 R' 3Uw2 Rw2 U 3Lw2 U' Fw2 3Lw2 U Fw2 Rw2 U' 3Fw2 Bw2 3Uw2 Lw2 3Lw2 3Rw2 3Uw2 Lw2 B' Rw2 3Rw2 Dw2 F Dw2 3Dw2 D' 3Lw2 3Fw2 R2 3Uw2 L 3Fw2 B L' R2 D' F 3Rw2 3Uw2 3Rw2 3Fw2 3Dw2 F D2 F' 3Lw2 3Uw2 R2 3Uw2 D' 3Lw2 D2 R2 F2 D' 3Fw2 3Lw2 3Rw2 U B2 R2 U 3Rw2 U' 3Bw2 U 2Fw2 2Uw2 L' F 2Lw2 F 2Dw2 R' F' U' 2Uw2 F R2 B 2Uw2 B' 2Bw2 L2 2Uw2 F 2Rw2 2Uw2 2Rw2 F' R2 D' 2Lw2 B2 U' B2 2Lw2 2Bw2 D 2Rw2 U R2 U 2Fw2 R2 2Bw2 B U' R' F' D' L' U2 B2 L2 D' B D' R2 D2 L2 F2 D' B2 D'",
                //8x8x8
                "4Dw2 3Lw2 4Bw 4Dw2 3Bw2 3Uw' 4Uw' 3Rw2 U' 4Bw 3Dw' 3Rw B' 3Lw 3Fw' 3Uw' 3Dw' 3Lw' 3Rw' 3Uw2 3Rw2 4Rw 3Uw2 B' 3Dw2 4Rw' D' 3Lw' 4Bw2 R 3Dw2 3Fw2 R 4Uw2 R' U2 3Rw2 U' 4Rw2 F 3Dw2 3Lw2 U 4Rw2 U F' 3Dw2 4Lw2 3Bw2 4Dw2 2Rw 2Dw' 4Rw F 4Fw2 2Bw2 4Dw2 2Dw 2Bw 2Uw' 2Rw2 2Fw 2Lw' 2Uw' D 2Lw' 2Rw 4Bw2 2Dw2 2Lw' D2 4Rw2 F 2Rw2 2Bw2 4Lw' 4Bw2 4Dw2 F' U' 2Dw2 R 4Bw2 R' 2Dw2 B2 4Rw2 B' 2Uw2 F' 4Rw2 F' 2Uw2 2Bw2 4Rw2 U' 2Lw2 4Rw2 U' B' D' L2 B 4Rw2 B 4Lw2 D' B2 U 4Lw2 U' L2 U' F2 4Rw2 3Dw' 3Rw' D 3Bw2 3Dw' 3Lw' 3Bw2 R 3Rw' 3Dw' 2Fw 2Uw 3Bw2 2Lw' 3Fw2 L 3Uw2 F 3Rw2 2Bw2 U F2 3Rw2 F2 2Uw 2Bw' D2 2Dw2 2Lw2 2Bw R 2Rw' 2Dw' B' 3Lw 3Rw 3Dw2 F' 3Rw 3Fw2 3Lw' 3Lw2 U 2Fw2 3Rw2 F' 3Dw2 F' 3Uw2 2Rw' 3Bw2 D' 2Bw2 D 2Lw B' D 2Lw F 2Fw2 2Rw' 3Bw2 2Uw2 R' 2Fw2 2Uw2 3Dw2 3Bw2 3Uw2 3Bw2 2Rw2 2Fw2 U' L2 3Bw2 U 2Bw2 3Lw2 3Fw2 2Bw2 3Dw2 2Lw2 2Rw2 3Rw2 B' 3Dw2 F' 3Uw2 2Dw2 3Dw2 2Rw2 3Uw2 D2 3Rw2 B' 3Rw2 3Fw2 B2 D 3Fw2 L' 3Bw2 D U2 F2 3Uw2 3Dw2 R2 F 3Lw2 B2 3Dw2 B' 3Uw2 D' 3Fw2 3Bw2 R2 D' 3Lw2 D 3Rw2 U 3Lw2 B2 D' 3Bw2 R2 D 3Lw2 D' B2 2Bw2 L U' 2Uw2 D2 R' L2 U' L2 2Rw2 B 2Dw2 2Fw2 B R2 B2 L2 2Uw2 B 2Rw2 B' 2Dw2 2Rw2 U' 2Fw2 B2 L2 D F2 L2 2Lw2 2Fw2 D' F2 L2 D2 2Fw2 2Rw2 2Fw2 U2 B' L' D' L' F R' U' F B2 L' B U R2 D L2 F2 R2 L2 U R2",
                //9x9x9
                "4Dw2 4Bw2 4Lw2 4Dw 4Bw 4Uw' 4Bw 4Lw2 R2 4Uw' 4Dw2 4Bw2 U' 4Lw 3Fw 4Dw2 4Lw2 4Bw2 U 4Lw F 3Uw' 3Bw' 4Lw 3Dw2 F' 3Fw' 3Dw' B2 3Lw2 3Fw' B 3Rw 3Dw' 4Lw' 2Bw 2Uw' 4Fw2 4Lw' 2Uw' 4Dw2 4Rw' U2 4Fw2 U 4Lw2 4Rw L2 3Dw2 B' 3Rw2 2Dw' 3Lw 2Rw' 3Uw2 3Rw F 2Dw' 3Lw' 2Dw2 2Bw2 R2 2Dw2 L' 2Uw 2Fw 2Lw2 U 2Rw 2Dw' B D2 4Dw2 4Rw U' B' 4Lw F 4Rw' 4Bw2 4Dw2 4Fw2 3Dw2 F' 4Rw2 U B' 4Rw2 D' 4Bw2 3Bw2 U' 3Lw2 F2 D' 3Rw' 3Fw2 U' F 3Lw' D' 2Rw' U' 4Rw2 B' 4Dw2 4Fw2 D' 2Rw B' 4Uw2 3Dw2 3Rw2 3Bw2 D2 3Dw2 3Lw2 F 3Uw2 3Fw2 2Dw2 2Rw' 3Fw2 2Bw2 2Rw 2Fw2 2Lw2 B D' 2Rw' U' D2 2Lw' 4Dw2 4Rw2 4Fw2 R' 3Uw2 4Bw2 R 3Bw2 4Dw2 4Bw2 4Rw2 3Fw2 3Bw2 4Bw2 4Rw2 4Fw2 3Lw2 U 4Fw2 U' 3Lw2 U' B2 3Uw2 F' 4Rw2 B' 3Lw2 D2 3Dw2 4Lw2 B' 3Rw2 F' 4Rw2 4Fw2 R 2Dw2 2Fw2 2Uw2 R' 4Bw2 R 2Bw2 R' L2 2Rw2 4Fw2 U2 2Bw2 4Lw2 U 4Rw2 U 4Fw2 B 2Lw2 B' 4Rw2 2Uw2 2Lw2 B' 2Rw2 2Dw2 2Lw2 B D2 4Lw2 R 3Bw2 3Dw2 R 2Bw2 3Bw2 3Dw2 U' 2Rw2 3Bw2 U' 3Lw2 2Rw2 3Fw2 2Rw2 2Fw2 U L2 3Bw2 3Dw2 B' 3Rw2 F2 3Lw2 F2 2Lw2 2Rw2 B' 3Dw2 3Lw2 2Rw2 F 4Lw2 4Bw2 R F' R' U' D' 4Bw2 4Lw2 4Uw2 L2 B2 4Uw2 L2 B 4Lw2 F 4Lw2 4Uw2 D2 F2 4Fw2 D 4Lw2 4Fw2 B2 U' R2 F2 4Lw2 U 4Rw2 B2 U' 4Fw2 L2 B 3Dw2 3Fw2 U' L' B' R' R2 D' B' 3Rw2 F D2 L2 B2 3Uw2 L2 U2 3Lw2 3Dw2 B' 3Uw2 3Lw2 D R2 U' R2 F2 3Fw2 U 3Rw2 3Bw2 L2 F2 3Rw2 U 3Fw2 3Bw2 R2 F R' 2Dw2 L2 U 2Bw2 L' 2Lw2 D R2 2Uw2 2Dw2 F' 2Uw2 2Lw2 B' 2Uw2 2Fw2 B' 2Lw2 B R2 2Uw2 2Fw2 L2 2Lw2 2Fw2 D' 2Fw2 R2 D 2Rw2 U' 2Fw2 R2 2Fw2 D 2Lw2 R' F' R' L' F2 U R L' D L' F D' B2 L2 U2 R2 U B2 D' F2 B2",
                //10x10x10
                "5Dw 5Rw2 5Fw' U F2 5Rw' 5Bw 5Dw B' 5Dw' D' 4Bw' L 4Dw 4Fw 4Rw' 4Dw' U2 D' 4Lw2 U' 5Rw' 5Dw2 4Lw' 4Bw2 4Lw2 B 4Lw' 5Rw' 5Bw2 4Dw2 R' 5Dw2 4Bw2 5Dw2 U 4Dw2 4Rw2 D' 5Rw2 U 4Lw2 B 4Uw2 4Lw2 B 5Rw2 4Fw2 5Dw2 3Bw' D' 5Lw R' 5Dw2 D' 3Bw' U' B' 3Lw2 3Fw' 3Dw' 5Dw2 B' 3Lw 3Dw2 5Bw2 5Dw2 5Rw2 U' 5Rw F' 3Lw' D' 3Rw' 5Dw2 5Rw2 5Fw2 3Dw2 3Rw2 B' 5Rw2 U' 3Lw2 D 3Rw2 B 5Rw2 3Bw2 U 3Lw2 3Dw2 5Dw2 5Rw 2Bw 5Bw2 2Rw' 2Fw' 5Bw2 5Rw' U D 2Lw2 2Bw' 2Rw' 2Dw' 5Dw2 5Bw2 2Rw' D2 5Rw' F' 2Lw2 B 2Bw2 2Dw2 2Lw' 2Uw2 5Lw' 2Rw2 2Fw2 R' F' 2Fw2 5Bw2 R 5Dw2 2Dw2 B 2Dw2 5Rw2 U 2Fw2 B 2Lw2 D 5Rw2 U 2Lw2 B' 5Rw2 B D F B 5Lw2 D' L2 U B2 5Lw2 U' B2 D 5Lw2 4Rw2 4Bw2 4Dw' B' 4Bw2 4Uw2 B' 4Dw' 3Dw' 3Bw' 4Rw 3Fw 4Dw2 4Lw U' D' 4Rw' 3Uw' 3Fw 4Lw' 4Rw' 3Bw2 D 3Fw 3Lw' 3Dw B D2 3Bw 3Uw' R2 3Fw' D 2Fw 2Dw 4Bw2 4Dw2 4Rw2 4Dw2 2Bw 4Rw' 4Dw2 2Bw2 D 4Lw 4Fw2 3Rw2 3Dw2 2Fw 2Dw 3Bw2 U' 3Rw 3Fw2 2Dw' 3Fw2 D' 3Fw2 U 2Bw2 D 2Lw' 2Fw2 2Rw 2Bw 2Lw' 2Uw' 4Rw2 4Dw2 B' D2 4Rw' U 4Lw D' 4Bw2 4Rw' 4Lw2 D' 4Fw2 4Lw2 F 4Dw2 4Rw2 F' 3Bw2 4Dw2 3Rw 4Bw2 B2 3Lw 3Rw' B' D' 3Rw F' 3Dw2 3Fw2 3Lw' 2Rw' 4Fw2 4Lw2 F' 2Uw2 4Lw2 4Bw2 U' 4Bw2 2Rw' 4Dw2 3Lw2 2Rw2 U 3Rw2 3Fw2 D 3Dw2 2Rw' 3Fw2 3Dw2 2Dw2 2Lw F 2Rw' U 2Dw2 2Rw U2 D 2Rw' 4Dw2 R' 4Dw2 4Bw2 4Dw2 R 4Uw2 3Bw2 4Bw2 R' U' 4Bw2 U' 4Rw2 U 3Fw2 L2 4Lw2 3Fw2 4Fw2 3Bw2 B2 3Lw2 F' 4Uw2 4Lw2 B 4Uw2 L2 3Rw2 4Dw2 F' 3Rw2 4Uw2 2Dw2 4Bw2 2Dw2 R' 2Bw2 2Uw2 R' 4Rw2 4Fw2 U' 2Rw2 U 2Fw2 4Fw2 L2 4Rw2 4Fw2 4Dw2 R2 4Uw2 2Dw2 B 2Lw2 B' 4Uw2 2Lw2 4Dw2 F B' 4Dw2 R' 2Fw2 2Uw2 3Bw2 3Uw2 2Fw2 2Uw2 R' 2Fw2 3Fw2 3Uw2 3Bw2 3Lw2 2Bw2 2Rw2 3Rw2 3Fw2 2Rw2 U' 2Bw2 3Lw2 U 2Fw2 3Dw2 B' 2Lw2 B' 2Dw2 3Dw2 3Rw2 B' 3Lw2 U2 2Rw2 3Dw2 F' 2Rw2 4Bw2 R' 4Rw2 D R' U' 4Bw2 L2 4Lw2 B 4Dw2 F2 4Lw2 F' L2 4Dw2 F' 4Bw2 D' 4Lw2 4Bw2 D L2 R2 D' 4Bw2 D' 4Lw2 U2 4Fw2 L 3Rw2 U F' D' 3Rw2 F' B R' R2 D' 3Uw2 D2 L2 U2 B' L2 3Dw2 R2 F 3Uw2 F' 3Dw2 L2 D 3Rw2 3Fw2 3Lw2 3Bw2 U 3Lw2 D B2 U 3Lw2 U R2 3Bw2 3Rw2 2Uw2 R2 U 2Bw2 U' L' D' 2Rw2 D2 2Dw2 2Lw2 2Dw2 F R2 2Dw2 2Bw2 2Uw2 D2 2Rw2 F' B2 D 2Lw2 D' 2Bw2 L2 U2 R2 2Fw2 2Rw2 D' 2Rw2 F2 2Lw2 2Bw2 U' F' L' F D' R' U2 L2 F' L' B' L2 D F2 U F2 B2 D R2 D2 R2",
                //11x11x11
                "5Dw2 L' 5Bw' 5Uw 5Fw U2 5Dw' 5Bw' L2 R 5Uw' 5Dw2 5Rw2 4Bw2 D 5Lw 5Fw2 4Uw 5Rw2 4Bw' 4Uw' 4Fw' 5Lw D' 4Rw2 4Bw2 4Dw' 4Bw' R 4Fw' 4Dw 4Fw' D2 5Fw2 5Dw2 5Rw 5Dw2 5Lw' 5Rw 3Fw 5Uw2 3Dw' L' 5Fw2 B' 4Rw2 4Bw2 4Rw' F' 4Dw2 3Fw 4Lw' 3Fw2 U2 3Uw' 4Rw 3Rw' 3Uw 3Fw 3Lw 3Rw' 3Uw' D' 5Lw2 5Rw 5Uw2 B 5Dw2 2Rw2 5Fw2 5Bw2 2Rw 5Uw2 2Bw2 2Uw' 5Rw' 4Rw2 2Bw' 4Uw2 4Lw2 4Rw F' 4Uw2 4Dw2 2Bw' 2Lw' F2 2Uw 4Lw' 3Fw 3Lw' 3Rw2 3Fw B2 3Lw R2 3Fw' R B 3Bw2 3Uw2 3Rw F' 3Dw2 R' 3Uw2 3Rw2 D2 2Fw' 3Rw B2 2Lw2 2Dw2 2Rw' 2Dw' L2 2Fw' 2Uw' 2Rw2 2Bw' 5Dw2 B' 5Bw2 5Dw2 5Lw' 5Rw2 B2 D' 5Rw' 5Lw2 5Uw2 4Lw 5Fw2 5Rw2 F' D' 5Dw2 4Rw 5Bw2 B 4Uw2 D' 4Lw F' 4Rw2 U' 4Rw' D2 4Lw' 5Uw2 5Lw2 D 5Lw2 5Dw2 5Lw2 F' 5Uw2 3Rw 5Dw2 D' 3Lw' 4Dw2 4Bw2 4Lw2 B 4Rw2 4Bw2 4Dw2 3Lw D' 4Rw2 D' 4Lw2 3Dw2 3Rw2 B' 3Lw2 D' 3Lw' 3Rw' 2Lw 5Rw2 5Uw2 5Lw2 2Rw 5Uw2 5Fw2 2Uw2 B' 5Uw2 D' 5Fw2 4Uw2 B2 4Lw2 F' 4Lw2 4Rw2 4Bw2 2Lw' D' 4Fw2 B2 3Dw2 3Rw' U 3Dw2 3Rw' U' D2 3Rw' 3Lw2 3Bw2 D' 3Fw2 2Lw' 3Dw2 B D 2Rw' 3Bw2 B2 2Lw' F 2Rw U' 2Uw2 B' 2Dw2 2Rw' 5Bw2 4Uw2 4Fw2 4Bw2 5Rw2 5Fw2 R 5Bw2 R' 5Fw2 4Dw2 5Rw2 4Fw2 5Lw2 U' 4Fw2 U 4Fw2 U 5Bw2 5Rw2 5Bw2 F2 4Rw2 U2 5Lw2 5Uw2 5Lw2 4Dw2 B' 5Uw2 5Lw2 F2 5Uw2 F 4Lw2 5Bw2 5Rw2 3Dw2 5Fw2 R' 3Dw2 3Fw2 R' 5Rw2 U2 3Fw2 3Lw2 3Rw2 5Rw2 3Bw2 U 3Lw2 5Rw2 U 5Bw2 5Rw2 F' 5Rw2 3Uw2 3Lw2 3Dw2 F 3Rw2 3Dw2 F' 5Rw2 D2 3Rw2 R' 3Bw2 R' 4Fw2 R' 4Fw2 3Dw2 4Dw2 R' 3Bw2 U 3Bw2 4Rw2 3Bw2 4Lw2 4Fw2 4Lw2 U' 3Fw2 U 4Fw2 B2 3Uw2 F' 4Dw2 F 3Dw2 F 3Rw2 4Rw2 3Uw2 3Dw2 4Dw2 B 4Rw2 5Rw2 5Bw2 2Dw2 R 5Dw2 5Rw2 5Bw2 2Dw2 R 2Uw2 2Bw2 5Lw2 2Fw2 U R2 2Bw2 U 2Lw2 5Fw2 5Lw2 5Fw2 5Dw2 2Rw2 5Dw2 5Rw2 F' 5Uw2 2Lw2 5Dw2 R2 B 2Dw2 5Lw2 5Dw2 R' 4Bw2 2Dw2 4Bw2 4Uw2 R' 2Uw2 L' 4Rw2 4Fw2 2Bw2 2Rw2 4Fw2 4Rw2 U' 2Lw2 2Fw2 2Bw2 U' 4Fw2 B 4Lw2 4Rw2 F 4Dw2 L2 4Rw2 2Uw2 F2 4Uw2 4Lw2 2Rw2 B 2Dw2 3Uw2 2Fw2 R' 2Dw2 R' 2Uw2 3Fw2 3Uw2 L 3Dw2 2Lw2 2Fw2 U' 2Rw2 2Fw2 3Fw2 U' 3Fw2 U' 3Bw2 B' 2Rw2 B2 3Uw2 3Rw2 2Uw2 3Uw2 B2 3Rw2 F2 B' 3Uw2 F2 2Lw2 F' 5Uw2 R' D 5Rw2 D2 B R' D' B' U2 5Dw2 5Lw2 5Uw2 F' 5Dw2 B' R2 B' D2 5Rw2 F' 5Fw2 D2 B2 U2 5Rw2 B2 5Lw2 D' 5Rw2 B2 U' 5Lw2 5Fw2 B2 5Lw2 B 4Dw2 R' D' B2 4Lw2 U R' B' U2 B' R2 B' U2 4Lw2 4Uw2 B2 4Rw2 4Dw2 F' 4Uw2 F2 D 4Bw2 D2 4Rw2 D 4Lw2 U 4Fw2 4Rw2 D' 4Rw2 U R2 D' 4Lw2 L2 3Uw2 F2 U2 3Uw2 3Lw2 B' R' D' F 3Rw2 3Uw2 F 3Rw2 F 3Rw2 U2 3Uw2 B' 3Rw2 F R2 U' 3Bw2 D' 3Rw2 D 3Lw2 3Fw2 3Bw2 U2 D' R2 F2 3Rw2 3Bw2 2Fw2 2Bw2 L D 2Rw2 D F' R' 2Lw2 D 2Uw2 F 2Lw2 B' L2 F' 2Bw2 R2 2Bw2 2Uw2 F' 2Rw2 2Dw2 D R2 2Rw2 D R2 F2 2Lw2 2Rw2 D' 2Lw2 D' 2Bw2 U F2 D' 2Lw2 R D2 R2 L' B' L F' U' B' U2 F D2 L2 U F2 R2 D' B2 U R2 L2",
                //12x12x12
                "5Dw' 5Bw L2 5Dw 5Fw' 5Dw' 5Rw 5Fw2 5Rw U' F' 5Lw' 5Rw' 5Dw2 R' 5Dw2 5Bw2 5Dw2 L2 D' 5Fw2 4Bw R' 4Fw' B' 4Lw2 4Uw' 4Bw' D' 6Dw2 4Rw2 F' 4Rw' U 4Lw' 6Fw2 4Uw2 R' 4Bw2 U 4Uw2 D' 4Lw2 B 6Lw2 U' 4Uw2 4Rw2 6Rw' D' 6Rw 3Dw2 3Fw' D' 3Rw' 3Uw' 3Fw' 3Bw 3Uw' 3Rw 3Uw2 3Fw2 6Rw2 3Fw2 B 6Rw B' 6Rw' F' 3Rw' F' D 3Bw2 6Rw2 3Fw2 B 6Rw2 F 3Fw2 D' 6Rw2 F 3Dw2 U 2Dw2 6Rw' U' 6Dw2 6Rw' 2Lw2 B' 2Bw' 2Dw' 2Fw 2Lw' 2Uw' 6Bw2 2Rw U' 6Rw' 6Dw2 6Rw2 2Bw2 2Rw2 2Fw2 2Rw F 2Lw' 6Lw' 2Lw2 2Bw2 2Uw2 L' U' B' 6Dw2 6Fw2 L' 6Rw2 B 2Rw2 2Bw2 D' 2Dw2 6Rw2 U B 6Rw2 2Fw2 B 2Rw2 6Uw2 L2 B' R2 D2 B 6Dw2 B' D' 6Bw2 D 6Lw2 U D 6Rw2 B2 U 6Fw2 5Dw2 F2 5Uw 5Fw2 5Bw 5Rw 5Bw L2 5Dw' 4Fw' 5Rw2 4Uw' 5Fw2 5Lw2 D 5Dw2 5Rw' 5Fw2 L 4Dw' 5Lw 5Rw2 4Dw2 4Lw U' 4Bw 4Lw' R 4Dw' 4Rw' 4Bw' 4Lw' 4Fw' 3Fw' 3Bw' 5Rw U' 5Fw2 U2 5Lw' D 3Bw 5Rw' 3Bw2 L' D' 5Fw2 4Dw2 3Bw 4Rw' 4Dw2 3Rw2 4Fw2 4Lw' 3Uw' 4Lw' 4Dw2 L 3Bw D2 4Lw B2 3Lw2 3Fw' 3Uw' 3Fw' 3Bw' 2Bw' 2Uw' 5Lw' B2 5Dw2 5Rw2 5Fw2 2Uw' 5Lw 5Bw2 2Lw' 2Dw' L' 5Dw2 4Bw2 4Uw2 4Lw' B 2Uw' 4Rw F' 4Dw2 4Rw2 2Uw' 2Fw' 4Rw' R 3Fw' 3Dw2 R' B' 3Uw2 3Lw2 3Rw' 3Bw' D2 2Bw2 2Uw' 3Fw2 3Dw2 3Rw 2Bw' 3Uw2 2Rw2 2Dw' 2Bw' 3Rw' 2Dw' F2 2Uw' 2Lw' B' D2 2Rw' 2Uw L' 2Lw2 2Dw' B2 5Rw D' 5Lw' 5Fw2 5Lw F B2 5Rw' 5Dw2 4Rw' 5Fw2 5Lw2 B 5Rw2 B2 4Lw D' 5Rw2 B2 5Lw2 D2 4Rw' F' B D' 4Lw' F 4Bw2 4Lw' D' 5Fw2 5Lw2 B' 5Rw2 D' 3Rw' 5Fw2 3Bw2 3Lw 5Uw2 5Lw2 4Dw2 4Fw2 4Lw2 4Rw2 F D' 4Lw2 4Rw2 D 4Fw2 3Rw 4Uw2 F' 3Rw2 B' 3Lw' D 3Rw' 5Fw2 5Rw2 5Dw2 2Lw B 5Lw2 D 5Bw2 U2 B 5Rw2 4Dw2 B D 4Lw2 4Fw2 U' 2Rw 4Dw2 F 4Uw2 B' 2Rw 4Uw2 3Rw 3Bw2 3Rw' F2 3Dw2 3Rw 3Bw2 3Rw' 3Lw2 U2 3Rw2 3Dw2 2Lw B' 3Uw2 2Rw 3Dw2 2Rw' U' 3Fw2 2Bw2 2Rw' B2 2Uw2 2Lw F' D' 2Bw2 2Rw' 2Uw2 2Lw' 4Bw2 5Uw2 R 5Dw2 4Bw2 5Uw2 R 4Dw2 5Bw2 R' 4Fw2 U' 5Rw2 5Fw2 U 4Lw2 U 4Lw2 5Rw2 4Fw2 5Fw2 B' 4Dw2 F 5Uw2 4Rw2 F R2 4Dw2 5Rw2 5Dw2 B2 4Lw2 5Dw2 5Lw2 5Bw2 3Uw2 3Dw2 5Bw2 R' 3Bw2 5Lw2 3Rw2 5Rw2 5Fw2 U 3Lw2 3Rw2 U' 5Bw2 3Rw2 3Uw2 5Lw2 5Rw2 5Dw2 F' 3Dw2 F' B2 3Rw2 D2 3Lw2 5Uw2 3Fw2 R 4Fw2 4Dw2 4Rw2 3Dw2 L' 4Bw2 4Uw2 U2 3Bw2 4Rw2 4Bw2 3Lw2 U' 4Lw2 4Bw2 U2 3Fw2 4Fw2 4Dw2 4Lw2 3Uw2 4Dw2 B 4Dw2 F B' 3Dw2 B2 3Rw2 4Uw2 3Lw2 4Lw2 5Rw2 5Uw2 2Fw2 R' 2Fw2 2Bw2 L 2Uw2 5Rw2 5Bw2 5Lw2 U' 2Lw2 5Bw2 U2 5Lw2 U' 5Bw2 5Lw2 U' 5Dw2 2Lw2 5Rw2 B 5Uw2 2Rw2 U2 5Rw2 5Dw2 L2 2Rw2 B' 5Uw2 2Lw2 4Uw2 2Bw2 R 2Uw2 2Dw2 R' 2Fw2 4Uw2 4Lw2 U' 2Lw2 U2 2Fw2 2Lw2 4Rw2 2Fw2 4Rw2 U' 4Dw2 2Rw2 4Uw2 B2 2Uw2 D2 4Lw2 F' 2Lw2 B 2Lw2 4Uw2 2Bw2 R 3Fw2 R 3Uw2 2Dw2 R' 3Bw2 2Dw2 2Bw2 2Lw2 3Bw2 3Rw2 U L2 3Bw2 2Lw2 U 3Bw2 U 3Bw2 2Lw2 B' 2Lw2 3Uw2 B2 2Uw2 R2 3Uw2 B' 3Rw2 3Uw2 2Rw2 2Uw2 5Bw2 5Rw2 5Uw2 L' U' 5Fw2 R' D 5Rw2 B' L2 5Lw2 D2 F' R2 5Rw2 F' R2 5Dw2 B' R2 D2 R2 5Bw2 D L2 U' 5Fw2 5Lw2 R2 F2 5Rw2 D' 5Lw2 U 5Lw2 U' R F' 4Rw2 F U2 R' L2 U' B 4Rw2 F D2 4Lw2 B 4Lw2 4Dw2 B2 4Dw2 4Bw2 4Lw2 B2 U 4Bw2 4Lw2 D 4Lw2 4Fw2 L2 U R2 F2 4Lw2 4Fw2 D B U 3Rw2 F L' F D' U2 F L2 B2 3Uw2 F' 3Dw2 F L2 3Uw2 F' 3Dw2 D 3Lw2 D' 3Fw2 D' B2 U' 3Rw2 F2 3Bw2 D 3Bw2 3Rw2 3Fw2 D2 3Rw2 F' D' 2Lw2 2Fw2 2Uw2 D' B' R' B U' 2Rw2 B' L2 F' 2Rw2 U2 2Rw2 F2 2Uw2 B' 2Rw2 2Dw2 F2 D 2Lw2 2Fw2 D' F2 2Fw2 D' 2Lw2 2Bw2 U L2 2Fw2 2Lw2 B2 2Lw2 U D2 L U F' D R' U2 R2 F' R D F2 U D2 R2 L2 U L2 F2",
                //13x31x13
                "5Rw F' 5Dw L B' 5Dw2 F 5Uw' 5Bw' 4Bw R' 5Fw2 4Dw 5Lw2 5Uw2 5Lw 4Dw' 5Rw' 4Uw2 4Fw 5Lw 5Rw2 L2 4Bw 4Dw 4Bw' 5Dw2 L 5Uw2 3Dw' 5Bw2 3Dw2 5Lw2 R2 5Dw2 5Lw' F2 3Bw 5Rw2 4Dw' 4Lw 4Rw2 4Dw 4Lw2 B2 4Lw' F2 4Uw' 3Fw 4Rw' F' 4Uw2 4Lw 3Bw' 4Rw 4Bw2 4Rw' 3Fw' 3Dw' 4Lw2 3Fw 3Rw U' 3Fw 3Lw 3Bw' 3Dw' 5Fw2 B 5Lw 5Uw2 2Rw' 2Uw' 5Lw2 B' 5Rw B 5Uw2 5Bw2 2Dw' 4Fw2 2Uw 4Rw 2Bw 4Lw 4Dw2 4Fw2 4Rw2 D' 2Fw2 4Rw 4Dw2 3Dw2 3Bw' 3Lw R' 3Fw2 B' 3Lw' 3Rw 3Bw' D 3Bw2 L2 B' 3Dw2 F2 D' 3Lw 3Rw' R' 2Rw2 B' 2Uw 2Fw2 R 2Fw' L2 2Lw' 2Dw' D 5Lw2 U' B 5Lw U 5Rw' F D 5Lw' 5Dw2 5Bw2 5Rw2 5Fw2 B2 5Dw2 F' 5Lw2 U2 5Rw2 4Dw2 4Lw' D' 4Rw' U' F 4Lw' U 5Rw2 F' 5Uw2 5Dw2 3Lw' 5Fw2 5Rw2 5Fw2 D 5Rw2 4Lw B 4Dw2 4Lw F 4Dw2 4Lw' B' D2 4Lw2 3Rw' 4Rw2 3Dw2 4Fw2 D 3Rw 4Dw2 B 4Uw2 3Lw2 3Rw2 D' 3Rw' F 3Lw' 2Dw2 2Lw 5Fw2 U 5Rw2 F' 2Lw' 5Dw2 F 2Rw' 5Bw2 4Dw2 B' 4Bw2 4Lw2 4Fw2 U' 4Lw2 F2 2Lw' D 4Dw2 4Fw2 4Dw2 3Lw 3Dw2 F' 3Lw F' B2 3Rw2 3Dw2 3Rw' 2Bw2 3Dw2 2Bw2 D' 3Lw2 B' 2Rw 3Uw2 D' 3Rw2 2Dw2 2Bw2 U' 2Lw D 2Fw2 2Rw' B' 2Dw2 2Lw' 6Rw2 5Dw2 5Fw2 U2 6Lw2 U 5Fw2 5Dw2 B2 6Rw2 B2 6Rw2 B2 5Dw2 5Lw2 5Rw2 4Fw2 U' 4Fw2 U' 4Rw2 F' 4Lw2 B 4Rw2 5Rw2 5Uw2 R' 5Fw2 L' 4Fw2 5Dw2 5Fw2 5Dw2 5Bw2 U' 5Fw2 4Bw2 L2 5Rw2 5Bw2 5Lw2 U 5Bw2 B 5Uw2 4Rw2 4Uw2 5Dw2 4Rw2 F2 5Uw2 5Rw2 F B2 4Rw2 F' 5Rw2 6Rw2 3Uw2 3Bw2 3Lw2 U2 6Rw2 U 3Bw2 B2 6Rw2 B2 6Rw2 F' 3Lw2 3Rw2 5Dw2 R 3Uw2 5Fw2 R 3Dw2 R 3Bw2 5Dw2 L' 5Bw2 3Lw2 5Lw2 U 3Fw2 U 5Fw2 U' 3Lw2 3Bw2 U 5Bw2 5Dw2 3Lw2 3Dw2 L2 5Dw2 3Lw2 5Lw2 F2 B 3Rw2 F' 5Lw2 5Rw2 3Dw2 4Dw2 R 4Dw2 3Fw2 R 4Uw2 4Rw2 4Bw2 4Dw2 4Bw2 3Lw2 3Rw2 4Fw2 4Lw2 U' 4Bw2 4Lw2 3Bw2 U2 4Fw2 3Dw2 B 4Uw2 4Rw2 B' 4Rw2 3Dw2 R2 3Uw2 4Uw2 F 3Uw2 3Lw2 4Dw2 2Bw2 L' 6Rw2 U2 2Bw2 2Uw2 F' 2Uw2 2Rw2 F' D2 6Lw2 B2 2Lw2 R' 5Fw2 2Bw2 R' 2Dw2 2Fw2 2Bw2 R' 5Rw2 U 2Rw2 2Bw2 5Lw2 U 5Bw2 U 2Rw2 2Bw2 U' B 5Rw2 F 5Lw2 5Dw2 F2 B' 2Lw2 2Uw2 2Dw2 5Rw2 F' 5Uw2 4Dw2 4Rw2 4Fw2 2Uw2 R 4Uw2 2Dw2 L' 2Fw2 4Uw2 4Bw2 4Rw2 U2 2Bw2 U' 2Bw2 R2 4Bw2 2Lw2 4Bw2 U' 4Rw2 2Dw2 F2 4Dw2 4Lw2 F 2Lw2 2Dw2 B2 2Dw2 F 2Dw2 4Dw2 2Dw2 3Dw2 3Bw2 R 2Fw2 R 2Fw2 3Uw2 L 3Bw2 3Uw2 2Rw2 3Bw2 U' 3Rw2 2Fw2 2Lw2 3Bw2 U' 2Fw2 2Bw2 3Bw2 3Lw2 D2 2Lw2 U2 3Uw2 L2 F 2Lw2 3Lw2 2Rw2 3Dw2 B 2Rw2 F2 B2 R' R2 U' B U2 6Lw2 B U2 D2 B' D' B2 6Rw2 U' R2 U 6Rw2 6Fw2 D2 6Rw2 U' L2 6Bw2 5Uw2 D L 5Lw2 D2 5Rw2 F' L' B' U' R2 B' 5Dw2 L2 D2 B2 5Rw2 U2 B 5Uw2 F' 5Lw2 5Dw2 D2 5Bw2 5Lw2 B2 5Rw2 B2 D2 F2 D' 5Lw2 D 5Bw2 U F2 5Lw2 U 5Fw2 4Lw2 D 4Bw2 4Dw2 L' U F L' 4Rw2 D 4Uw2 B 4Dw2 R2 B D2 F D2 4Dw2 B' 4Dw2 L2 4Uw2 F2 U B2 L2 4Fw2 D 4Lw2 R2 U2 R2 4Bw2 4Lw2 B2 D 4Rw2 D2 R' B' 3Lw2 R' U' R' B' U' F 3Dw2 F' 3Rw2 3Uw2 R2 3Dw2 B U2 B' 3Rw2 B 3Bw2 D 3Rw2 D L2 U 3Lw2 U 3Fw2 D' R2 U 3Bw2 U2 D' 2Bw2 R' F2 D' F' 2Bw2 R' B' U' D2 2Rw2 B' 2Rw2 U2 B 2Uw2 2Lw2 B 2Lw2 2Uw2 2Rw2 B' U 2Rw2 D2 R2 D L2 2Fw2 2Rw2 F2 2Rw2 D' 2Fw2 B2 2Rw2 2Fw2 R U2 F' D' B L F B D R U2 B' R2 U F2 D' L2 B2 D F2 U' L2",
                //14x14x14
                "6Dw2 7Rw2 6Uw' 6Lw' 7Bw2 R2 6Bw2 6Lw' 7Dw' R 6Uw' 6Fw' 6Dw' 6Rw2 6Bw 6Uw' U B2 6Bw2 6Lw2 F 7Bw2 6Lw2 6Dw2 7Rw' 6Uw2 B 7Rw' 7Dw2 R' 6Dw2 7Bw2 R' 7Uw2 6Lw2 B' 6Uw2 6Rw2 7Rw2 D 7Rw2 U 6Dw2 F2 6Lw2 F 7Rw2 5Uw' F2 7Rw 5Fw' 7Fw2 B 7Rw 5Dw2 5Bw2 D' 5Bw' 5Rw U 5Fw' D 7Bw2 5Rw 5Fw2 5Bw2 7Rw U' D2 5Lw F' 7Lw' 7Dw2 5Lw' 5Uw2 5Dw2 7Rw2 5Bw2 R' 7Uw2 F' 5Rw2 7Rw2 5Dw2 5Rw2 B2 5Uw2 D 5Lw2 B 7Lw2 4Dw2 B2 7Bw2 7Rw2 B 7Rw 7Bw2 4Dw' 4Fw' B' 4Uw 4Dw' 4Fw' 4Uw2 4Lw' 4Dw2 4Rw' B D 4Rw' 4Bw2 7Bw2 7Lw' U 4Lw' 7Rw2 4Fw2 R 7Bw2 R' 7Uw2 B' 4Bw2 7Rw2 D 4Rw2 F' 4Lw2 U 7Rw2 F' 4Rw2 U2 7Rw2 4Bw2 D2 7Lw2 R 7Dw2 R' 7Bw2 3Dw2 3Fw 3Dw' 3Bw2 3Rw' 3Fw' 3Uw' 3Dw2 3Rw F D 3Lw 7Dw2 F' 7Rw2 U' 3Rw' 3Dw2 7Rw2 7Dw2 R 7Dw2 B' 3Bw2 3Uw2 7Rw2 U 3Fw2 B' 3Uw2 3Fw2 3Rw2 D 7Lw2 3Dw2 7Dw 7Rw2 2Uw' 7Rw2 B 2Bw' 7Dw' 2Dw2 B2 2Uw 2Lw F' 2Bw 2Dw' D2 2Lw D 2Rw' 7Rw2 F D 7Rw2 B' 2Rw' U 2Lw' B' U R' 7Dw2 R' 2Dw2 2Fw2 L 7Bw2 2Bw2 7Rw2 U' 2Uw2 2Rw2 7Rw2 F' D' 2Dw2 7Lw2 U2 B' 2Rw2 F' 7Uw2 F' U' 7Rw2 7Bw2 7Uw2 B D' B2 7Lw2 D2 L2 7Bw2 U R2 7Bw2 R2 6Dw 6Bw2 D2 6Rw' F2 6Lw2 R' 6Uw' 5Bw' 6Dw2 5Lw2 5Dw 6Lw2 6Uw2 D 6Lw' 6Fw2 5Rw' 5Dw 5Bw' 6Rw2 5Fw 5Rw' D' 5Fw 5Rw' 5Fw2 5Bw' L' 5Uw' 6Dw2 4Bw' 6Dw2 6Lw 4Uw' 6Uw2 6Fw2 4Bw 6Uw2 D2 6Rw B' 4Rw 4Fw' 6Rw' 4Dw 5Rw2 4Fw' 5Fw2 5Dw2 R 5Uw2 5Rw' 5Fw2 D2 5Rw2 D' 5Bw2 D 4Fw 4Uw' 4Bw' R2 4Fw' 4Uw' B 3Dw' 6Fw2 6Lw 6Rw' 6Uw2 3Dw 6Rw U2 3Lw' B2 3Bw' 6Lw 3Dw' 5Rw' 5Bw2 R' 5Fw2 3Dw2 3Lw2 5Lw' 3Bw 5Rw2 3Uw B2 5Rw 4Bw' 4Lw' U' 4Rw2 U L' 4Uw2 4Dw2 4Fw' 4Rw' 4Fw2 3Rw2 3Fw 4Uw2 4Rw' B' 4Dw2 3Rw 4Bw2 U 3Uw' 4Rw 3Rw 3Fw' 3Dw2 F' 3Uw' 3Bw' 2Fw' 6Rw 2Bw' 2Dw 6Lw2 2Dw' 6Fw2 D' 6Rw' 2Uw 2Fw D' 6Lw2 D' 5Dw2 5Lw 5Rw D 5Bw2 2Rw' 5Bw2 5Rw 2Bw' R' 5Bw2 2Fw 4Lw 4Rw 4Uw2 4Bw2 2Dw 4Fw2 2Dw2 2Lw 2Uw 4Rw' 3Dw' 3Lw' U R' 3Rw' 3Dw' L 3Rw2 3Dw' 2Dw' 3Bw2 3Uw2 3Bw2 3Lw2 2Fw' B 3Rw2 2Dw 3Lw 2Uw2 2Fw 3Rw U' B2 2Lw' 2Dw' 2Rw2 F2 2Bw 2Dw R 2Bw' 6Dw2 F B 6Rw' 6Fw2 6Lw' U' 6Dw2 B' 6Rw' 6Dw2 B' 6Bw2 6Lw2 D 5Fw2 5Rw' 6Uw2 5Rw' 6Bw2 D' 5Lw B D 5Rw' U D2 5Lw 5Rw' F 5Rw' 4Bw2 6Lw2 6Fw2 D' 6Bw2 4Lw F' 6Dw2 B' 5Rw2 5Fw2 5Rw2 U' 5Lw2 4Rw 5Dw2 4Rw' 5Fw2 4Rw' 5Bw2 B2 4Lw2 B' 4Rw' U' 4Lw' 4Rw' 6Rw2 6Dw2 F' D' 6Fw2 3Rw 6Dw2 F' 6Lw2 D' 6Bw2 D2 5Rw2 U F' 5Lw2 5Bw2 5Lw2 3Rw' B' 5Uw2 4Rw' F 4Lw2 4Rw F 4Bw2 4Rw' 4Fw2 4Rw' D' 4Rw2 4Fw2 4Bw2 4Dw2 3Rw F 4Uw2 3Lw' F 4Lw2 U 4Bw2 D' 3Dw2 3Fw2 U' 3Lw' B 3Rw' F' 6Lw2 B 6Rw2 B 2Rw 6Bw2 6Dw2 2Lw' B D 6Lw2 5Fw2 D' 2Rw' 5Uw2 B' 5Rw2 5Bw2 2Lw2 5Rw2 F' 5Bw2 D2 5Lw2 D' 2Lw' 4Fw2 B' 4Uw2 F' 4Rw2 4Bw2 D 4Fw2 2Rw 4Dw2 3Rw D' 3Bw2 D' 3Rw' 3Dw2 3Rw2 B2 3Rw' F 2Lw' U 3Rw2 2Dw2 F' 3Uw2 D' 2Lw F' 3Rw2 B D2 2Lw' 2Rw' D 2Dw2 2Lw2 F' 2Lw' 6Rw2 5Bw2 6Bw2 R 6Uw2 5Bw2 6Dw2 5Bw2 6Bw2 R' L2 6Bw2 U 5Bw2 6Lw2 U R2 5Bw2 6Bw2 U' 6Fw2 5Lw2 6Uw2 6Lw2 6Rw2 F' 6Rw2 D2 6Lw2 5Rw2 F 5Lw2 F2 6Dw2 6Uw2 4Dw2 R 4Dw2 4Fw2 4Bw2 L' 4Dw2 4Lw2 6Lw2 U 4Fw2 U 6Lw2 4Bw2 6Bw2 4Lw2 6Bw2 6Dw2 6Lw2 F2 6Dw2 4Rw2 B 6Uw2 4Dw2 B2 6Rw2 B 6Lw2 B2 4Uw2 5Dw2 R' 5Dw2 5Bw2 4Uw2 4Dw2 5Rw2 4Bw2 L' 5Bw2 4Dw2 5Rw2 U' 5Lw2 5Bw2 4Rw2 5Fw2 4Bw2 5Rw2 4Bw2 U 5Fw2 5Dw2 5Rw2 4Dw2 4Lw2 5Dw2 B 5Dw2 F D2 4Rw2 5Uw2 4Dw2 5Lw2 F' 5Dw2 R' 3Bw2 6Dw2 R' 3Dw2 3Fw2 3Uw2 L 3Uw2 3Bw2 6Lw2 U 3Lw2 3Fw2 6Rw2 U2 6Lw2 6Fw2 3Rw2 U' B2 6Lw2 3Dw2 6Dw2 F' 3Dw2 F' 6Rw2 3Uw2 6Rw2 6Dw2 6Rw2 D2 3Lw2 R 3Fw2 5Bw2 R 3Uw2 5Rw2 3Dw2 3Bw2 R' 3Lw2 U' 3Bw2 U' 3Bw2 U 3Bw2 5Lw2 U 3Lw2 5Fw2 B 5Lw2 5Uw2 5Lw2 F 3Dw2 3Lw2 R2 5Dw2 3Rw2 5Uw2 F 3Rw2 3Dw2 4Fw2 R' 4Uw2 3Dw2 R 4Dw2 4Bw2 L 4Dw2 4Rw2 U' 4Bw2 U' 4Fw2 3Rw2 U2 R2 3Bw2 U' 3Rw2 D2 4Lw2 B2 4Uw2 4Lw2 3Uw2 3Lw2 4Rw2 B' 4Dw2 4Rw2 B' 4Uw2 6Rw2 2Uw2 R 6Bw2 R 2Fw2 R' 6Fw2 2Uw2 U2 2Bw2 2Lw2 6Rw2 6Fw2 6Bw2 U' 2Bw2 2Lw2 2Rw2 U' B2 6Dw2 F' D2 6Rw2 2Dw2 2Rw2 6Rw2 B 6Dw2 2Rw2 6Dw2 6Rw2 5Dw2 R' 2Dw2 R' 5Uw2 2Dw2 R 2Dw2 2Bw2 L' 5Lw2 U 2Rw2 U' 2Bw2 5Bw2 R2 5Bw2 B2 5Lw2 B' 2Uw2 B' 5Dw2 F' 2Rw2 B2 2Rw2 2Uw2 F' 5Dw2 4Rw2 4Dw2 R' 2Bw2 4Rw2 2Fw2 L' 2Bw2 2Lw2 2Rw2 U' 2Fw2 4Rw2 U2 4Lw2 4Fw2 U' 2Uw2 B2 4Uw2 4Rw2 4Dw2 B2 2Dw2 F' 2Rw2 2Uw2 F' 4Uw2 3Dw2 2Bw2 3Uw2 2Dw2 R' 3Bw2 2Uw2 3Uw2 L 2Uw2 2Lw2 U 3Rw2 3Bw2 2Lw2 U 3Bw2 2Lw2 3Fw2 U 2Lw2 2Bw2 D2 2Rw2 F 3Rw2 F' 2Lw2 3Lw2 F' 3Lw2 2Dw2 B' 3Lw2 3Rw2 2Uw2 6Lw2 6Rw2 D' F' R' F2 L' B' R2 6Uw2 B' U2 6Lw2 F 6Dw2 F' D2 6Rw2 B 6Dw2 B2 R2 6Fw2 6Lw2 R2 U' B2 U' D2 6Fw2 R2 U' 6Fw2 6Bw2 L' 5Bw2 5Rw2 F 5Uw2 R' D F2 R' R2 D' B 5Dw2 L2 5Dw2 F 5Lw2 F' 5Uw2 B2 5Dw2 R2 5Dw2 R2 F2 5Fw2 D' 5Rw2 D2 5Fw2 R2 5Bw2 L2 D2 F2 5Fw2 5Lw2 D 5Fw2 4Uw2 4Lw2 F' 4Fw2 D2 R 4Dw2 L' 4Fw2 U' 4Fw2 R2 B' 4Rw2 U2 4Dw2 B' R2 B2 D2 4Lw2 4Uw2 4Dw2 F 4Fw2 L2 D' B2 U2 L2 4Lw2 D' 4Rw2 F2 D F2 L2 4Bw2 4Lw2 U2 3Dw2 L' 3Bw2 3Lw2 F 3Uw2 B' R' B D 3Rw2 D2 3Bw2 R2 3Dw2 B' L2 B 3Uw2 3Rw2 3Dw2 L2 F 3Uw2 D' R2 D B2 L2 D2 3Bw2 L2 3Bw2 R2 U 3Rw2 3Fw2 D 3Bw2 U' 3Fw2 L B2 2Uw2 D' 2Rw2 D 2Bw2 L' 2Bw2 D 2Lw2 F' 2Lw2 R2 B2 2Uw2 2Rw2 2Dw2 B' 2Uw2 F' 2Bw2 2Uw2 D L2 R2 D 2Lw2 2Fw2 U' 2Lw2 D2 2Rw2 F2 D' 2Lw2 2Fw2 2Bw2 U' 2Fw2 U R2 F R2 B2 L2 U' L D F L U2 L2 D2 F2 D F2 B2 U' B2 D'",
                //15x15x15
                "7Lw2 7Fw 7Dw 7Rw' D2 7Rw' 7Bw' 7Uw' L2 7Fw' D' 7Rw2 7Bw2 7Lw2 B' 7Dw2 7Rw U' 7Fw2 6Lw' 6Fw 7Lw' 6Dw 6Fw U F 6Bw 6Lw 6Rw F' 6Fw' 6Uw' L2 7Uw2 7Dw2 B2 7Rw 7Dw2 5Rw2 U' F 5Fw 7Lw' 6Dw2 B' 6Uw2 6Lw' 6Uw2 6Rw2 5Dw' 6Fw2 5Lw2 5Fw' B' 6Lw' 5Bw2 5Dw' R' 5Dw' B' 5Uw' 5Fw' 7Dw2 F2 7Uw2 7Fw2 7Lw2 4Uw' 7Lw' 4Fw' 7Uw2 4Dw2 4Lw F 7Lw' 4Bw D' 6Fw2 6Rw 6Dw2 4Fw L' 6Dw2 6Rw D 4Bw U2 6Lw 5Bw2 L2 F 5Dw' 5Bw2 5Lw B2 5Lw' 5Dw' 5Dw2 R2 5Fw2 5Bw2 5Rw 5Dw2 5Rw' 4Uw' 5Fw2 R' 4Bw 4Dw 5Lw 4Rw' 4Dw 4Fw2 L2 F' 4Bw' 4Uw' 3Dw' 7Bw2 7Dw2 F' 7Uw2 7Bw2 7Rw' U' 3Bw 7Dw2 7Rw2 3Bw 3Rw 7Bw2 3Dw' 6Lw 3Bw' 3Uw' 6Fw2 3Dw' 6Bw2 6Lw2 3Bw' 6Uw2 L 3Dw 6Bw2 3Bw' 5Rw 3Dw' 5Lw 5Uw2 5Fw2 3Dw' 3Bw2 5Lw2 3Rw' 3Bw' 5Lw L2 D' 4Bw 4Lw2 4Uw R' 4Uw 4Dw2 4Fw' 3Dw 4Lw 4Fw2 3Bw2 4Dw2 3Fw' 3Bw' 4Lw' U2 D' 4Rw' 3Dw' F2 3Bw 3Rw2 3Bw' 3Dw' D2 2Fw 7Rw2 7Fw2 7Lw' F' 7Uw2 2Rw' 7Rw' 2Uw' 7Rw 2Bw2 6Rw2 U' 6Uw2 6Bw2 2Rw 6Fw2 2Uw 6Lw2 2Rw2 2Fw 6Lw' 5Bw2 2Uw 5Lw' 5Uw2 2Dw' B' 5Lw 2Bw2 5Rw 2Fw2 2Dw' 5Rw' 2Dw' 4Rw' 2Dw' 4Lw' 4Bw2 2Uw 4Lw2 2Bw 4Rw 2Fw' 2Dw 4Fw2 3Dw2 B 3Uw 3Bw2 R 3Rw' 3Fw2 3Lw2 R2 3Dw' 3Lw 2Fw 3Dw2 3Bw2 3Lw' 3Dw2 2Rw' 3Bw2 2Lw 2Dw' F 3Rw' 2Uw 2Rw2 2Fw L2 2Uw 2Dw 2Bw' 2Dw' R2 2Uw' 7Fw2 7Lw' D' 7Lw' 7Uw2 F' 7Rw' U' 7Lw' 7Dw2 F' 7Rw2 7Dw2 7Bw2 6Lw' U' 7Bw2 6Rw' 7Fw2 U 6Rw 6Fw2 6Lw' D 6Rw B' 6Uw2 6Rw' 7Dw2 7Rw2 7Uw2 5Lw' F' 7Dw2 7Rw2 U' 5Lw B' 7Uw2 6Uw2 D' 5Lw B' 6Uw2 6Lw2 5Rw' 6Dw2 5Rw' 6Uw2 6Bw2 5Rw F D' 5Rw' 7Dw2 4Rw' U 4Lw 7Fw2 7Uw2 D2 7Lw2 4Uw2 F 7Lw2 D' 6Lw2 4Rw' F' 6Fw2 6Rw2 B' 6Dw2 4Rw 6Bw2 5Rw' B2 D' 5Bw2 5Lw2 D' 5Dw2 5Rw' 5Bw2 D' 4Lw2 5Bw2 4Rw B 5Dw2 4Rw' U' 4Lw2 B' 4Lw' 4Rw' 7Dw2 B 7Rw2 7Uw2 D 7Bw2 7Dw2 3Rw' B' 7Dw2 6Uw2 6Fw2 6Bw2 6Rw2 F D 6Lw2 B' 3Rw 6Rw2 6Bw2 5Rw2 5Fw2 5Dw2 3Rw' 5Uw2 5Rw2 5Fw2 B' 3Lw' D' 5Rw2 D2 4Rw F 4Dw2 B2 4Lw B 4Uw2 4Lw' B' 4Rw2 4Fw2 B' 3Rw' 4Uw2 4Fw2 U B' 4Bw2 4Uw2 4Bw2 3Lw' F 3Rw' U' B D' 3Rw' D2 7Bw2 7Dw2 7Rw2 7Dw2 B D' 2Rw' 7Bw2 7Uw2 6Dw2 6Fw2 U' 6Lw2 D 6Bw2 6Dw2 2Lw' 6Uw2 F' 6Rw2 B' 5Rw2 5Dw2 2Lw' U2 5Rw2 5Fw2 2Rw' 5Uw2 D' 4Rw2 4Dw2 4Bw2 4Dw2 F' 4Lw2 B 2Lw' 4Fw2 U 4Lw2 3Rw' U2 3Rw' D2 3Dw2 3Bw2 3Rw 3Uw2 3Rw' 2Uw2 2Lw 3Lw2 3Dw2 3Lw2 U' 3Bw2 3Uw2 D' 3Bw2 F' B' 2Lw' 2Rw' F 2Bw2 D 2Fw2 2Lw' 7Bw2 R' 7Uw2 6Fw2 R 7Bw2 7Dw2 R' 7Fw2 7Uw2 6Dw2 L2 7Rw2 7Fw2 7Rw2 7Fw2 6Lw2 U' 6Bw2 7Rw2 7Fw2 7Bw2 B' 7Uw2 B 6Dw2 6Rw2 7Rw2 F' 7Lw2 7Dw2 B 7Rw2 7Dw2 6Lw2 6Dw2 7Fw2 5Uw2 7Bw2 5Uw2 R 5Fw2 7Fw2 7Dw2 7Fw2 R' 5Bw2 7Lw2 5Rw2 7Rw2 7Fw2 U 5Rw2 7Bw2 L2 7Fw2 U' 7Dw2 B 7Dw2 B 7Lw2 5Rw2 7Rw2 B 7Uw2 L2 B' 5Dw2 5Lw2 7Uw2 5Rw2 6Dw2 R' 6Fw2 R' 5Dw2 6Fw2 6Rw2 5Fw2 6Dw2 R' 6Rw2 6Bw2 5Rw2 U 6Bw2 U 5Rw2 6Fw2 5Bw2 6Bw2 6Lw2 5Bw2 U2 5Lw2 6Dw2 6Lw2 5Dw2 6Dw2 L2 F 5Lw2 B2 6Lw2 6Dw2 7Rw2 7Fw2 R' 4Uw2 L 7Dw2 7Fw2 7Bw2 4Uw2 7Bw2 U' 7Rw2 U2 L2 7Lw2 4Bw2 4Rw2 U 7Fw2 4Bw2 7Uw2 7Lw2 F' 4Lw2 4Dw2 B' 7Uw2 4Rw2 7Rw2 D2 4Dw2 7Lw2 4Dw2 6Bw2 6Rw2 6Dw2 R 6Dw2 L 4Bw2 6Uw2 4Bw2 U2 6Rw2 6Fw2 U' 4Lw2 4Bw2 U' 6Fw2 6Bw2 U' B2 D2 6Dw2 4Rw2 6Uw2 6Lw2 F' 4Lw2 B' 4Uw2 B2 4Rw2 6Dw2 6Rw2 4Dw2 4Fw2 R 5Bw2 4Uw2 R 5Dw2 5Rw2 5Uw2 R 5Fw2 4Uw2 U' L2 5Lw2 4Fw2 U' 5Fw2 U 5Bw2 U2 5Lw2 U' 5Uw2 4Rw2 5Dw2 B' 4Dw2 5Lw2 B 5Dw2 4Lw2 B' 5Lw2 U2 4Rw2 7Dw2 7Rw2 7Bw2 3Uw2 R' 7Dw2 R' 3Dw2 3Bw2 7Dw2 7Bw2 3Lw2 3Fw2 U' 7Rw2 U 7Fw2 3Bw2 U 7Lw2 U' 7Bw2 7Dw2 B2 7Lw2 7Uw2 3Dw2 F' 7Rw2 F2 7Uw2 3Lw2 F 7Lw2 3Rw2 3Dw2 3Fw2 L 6Bw2 6Dw2 3Fw2 3Dw2 6Dw2 6Bw2 6Lw2 3Fw2 U 6Bw2 6Lw2 6Fw2 3Rw2 U 6Fw2 6Rw2 F' 6Lw2 B 6Dw2 F' 6Rw2 D2 3Lw2 3Rw2 B 3Rw2 6Uw2 R' 5Bw2 R' 3Bw2 3Uw2 R' 5Bw2 5Lw2 U2 L2 3Rw2 5Bw2 5Rw2 U 3Bw2 U 3Bw2 5Dw2 3Lw2 F 5Lw2 F 3Rw2 B' 5Lw2 F' 3Rw2 3Dw2 5Lw2 F2 5Dw2 3Dw2 R' 3Uw2 4Dw2 R' 3Dw2 3Fw2 3Bw2 R 4Fw2 3Uw2 4Dw2 3Bw2 3Lw2 R2 4Bw2 U' 3Fw2 4Lw2 U 4Lw2 3Fw2 U' 4Dw2 4Rw2 4Uw2 4Lw2 4Rw2 B 3Lw2 4Lw2 3Uw2 L2 4Dw2 3Lw2 F' 3Rw2 7Dw2 R' 2Uw2 7Fw2 7Uw2 2Fw2 2Uw2 7Uw2 7Fw2 L' 7Bw2 2Lw2 2Bw2 7Rw2 U' 7Bw2 U2 2Lw2 2Bw2 U 7Fw2 7Lw2 7Dw2 B' D2 7Rw2 F 2Uw2 7Rw2 F2 7Dw2 2Lw2 B 2Rw2 2Dw2 6Dw2 R' 6Dw2 2Bw2 2Uw2 6Dw2 L 6Fw2 2Uw2 6Bw2 U 6Rw2 U 2Bw2 6Rw2 6Fw2 U' 2Bw2 6Rw2 U' 6Lw2 2Rw2 6Uw2 2Lw2 2Uw2 B 6Uw2 2Dw2 6Dw2 F D2 2Lw2 6Uw2 6Lw2 2Uw2 5Rw2 2Fw2 R 5Bw2 5Uw2 2Bw2 2Uw2 5Uw2 R2 5Rw2 2Bw2 U' 2Fw2 U2 5Fw2 2Rw2 5Fw2 U 5Bw2 B2 5Lw2 5Dw2 B 5Lw2 2Rw2 2Uw2 5Rw2 D2 2Lw2 2Dw2 F 5Dw2 5Lw2 2Dw2 4Fw2 2Dw2 R' 2Dw2 4Fw2 2Uw2 4Fw2 2Uw2 R' 4Rw2 U2 4Fw2 U2 4Lw2 U' 2Lw2 2Rw2 U' B2 4Lw2 4Dw2 F' 2Rw2 F 4Lw2 R2 2Uw2 4Lw2 4Dw2 3Rw2 3Bw2 R 2Bw2 3Dw2 3Bw2 R' 3Dw2 2Fw2 3Dw2 3Bw2 3Lw2 2Fw2 U' 3Rw2 2Bw2 3Lw2 3Bw2 2Lw2 U 2Rw2 3Fw2 B' 3Uw2 2Lw2 B 3Dw2 B 2Lw2 D2 2Rw2 3Rw2 3Uw2 B2 3Rw2 7Dw2 B' U' 7Fw2 L' 7Rw2 U' R' B' F U2 F' 7Uw2 7Lw2 R2 7Uw2 7Rw2 B 7Rw2 D2 B' 7Uw2 7Lw2 U 7Lw2 7Fw2 D 7Fw2 D2 7Lw2 B2 7Rw2 7Fw2 R2 D' B2 7Lw2 6Uw2 6Lw2 R' F 6Lw2 6Rw2 D R' B D 6Lw2 F' U2 6Dw2 6Rw2 D2 F2 6Rw2 B R2 6Dw2 D2 6Bw2 D2 6Fw2 U' L2 R2 6Rw2 D2 6Fw2 U 6Bw2 D2 6Lw2 F2 6Rw2 5Fw2 U F 5Fw2 5Rw2 D2 F L' R2 U' D2 B' 5Dw2 F 5Uw2 B' 5Uw2 L2 5Uw2 R2 B 5Uw2 D' F2 D' 5Rw2 B2 5Lw2 D' 5Lw2 5Rw2 D2 5Bw2 L2 R2 U 5Fw2 B2 5Lw2 4Rw2 B R 4Fw2 L' 4Lw2 F L' R2 U' F' 4Lw2 R2 U2 B2 4Lw2 B' D2 4Lw2 4Dw2 F 4Dw2 B' D' 4Bw2 D R2 F2 U2 4Lw2 4Bw2 4Rw2 D' 4Fw2 D' 4Lw2 B2 4Rw2 L U 3Rw2 B L' B' U' B 3Uw2 3Dw2 B 3Uw2 D2 3Lw2 F' U2 D2 3Rw2 F 3Uw2 D' F2 B2 3Lw2 U R2 3Rw2 3Fw2 D 3Rw2 3Fw2 D 3Lw2 R2 U' 3Lw2 3Fw2 F 2Lw2 2Bw2 D' L2 2Lw2 B 2Uw2 L' B' U' F R2 F L2 2Lw2 D2 2Bw2 2Uw2 B' 2Lw2 F 2Uw2 B' 2Dw2 2Rw2 2Fw2 2Bw2 U 2Fw2 B2 2Lw2 U' F2 L2 2Fw2 2Rw2 D' 2Fw2 2Lw2 R2 D L2 D F' U2 F2 L' U' R' U L2 U D F2 L2 B2 L2 D'",
            };
            int dim = Convert.ToInt32(textboxDimension.Text);
            if (dim <= 15)
            {
                textboxCubeString.Text = democubes[dim];
                textboxMoves.Text = demosols[dim];
            }
            else
            {
                int depth = dim * dim * 3;
                Scrambler s = new Scrambler(dim, depth);
                c = new Cube(dim);
                for (int i = 0; i < s.Moves.Length; i++)
                {
                    c.Move(s.Moves[i]);
                }
                textboxCubeString.Text = c.CubeString;
                textboxMoves.Text = "";
            }
            c = new Cube(textboxCubeString.Text.Trim());
            c3d = new Cube3D(c);
            cw.Cube3D = c3d;
            c3d.AnimationCompleted += C3d_AnimationCompleted;

            ShowWholeCube();
            initMoves();
        }

        private void btnCreateByCubeString_Click(object sender, RoutedEventArgs e)
        {
            c = new Cube(textboxCubeString.Text);
            c3d = new Cube3D(c);
            cw.Cube3D = c3d;
            c3d.AnimationCompleted += C3d_AnimationCompleted;
            ShowWholeCube();
        }

        private void textboxMoves_TextChanged(object sender, TextChangedEventArgs e)
        {
            initMoves();
        }

        private void initMoves()
        {
            if (listboxMoves != null)
            {
                moves = textboxMoves.Text.Trim().Split(" ");
                listboxMoves.Items.Clear();
                listboxMoves.SelectedIndex = -1;
                foreach (var item in moves)
                {
                    listboxMoves.Items.Add(item);
                }
                currentMoveID = 0;
                autoMoving = false;
                textblockCubeString.Text = "";
            }
        }

        private void btnMove_Click(object sender, RoutedEventArgs e)
        {
            if (moves.Length != 0)
            {
                Rotation t;
                t = new Rotation(moves[currentMoveID].Trim());
                currentRotation = t;
                listboxMoves.SelectedIndex = currentMoveID;
                listboxMoves.ScrollIntoView(listboxMoves.SelectedItem);
                if (checkboxAnimation.IsChecked ?? false)
                {
                    int speed = Convert.ToInt32(sliderAnimationSpeed.Value);
                    int stop = Convert.ToInt32(sliderAnimationStop.Value);
                    c3d.Seperate(new Seperation(c3d.Dimension, t));
                    ShowSepertatedCube();
                    c3d.RotateWithAnimation(t, speed, stop);
                }
                else
                {
                    c.Move(t);
                    ShowWholeCube();
                    currentMoveID++;
                    if (currentMoveID == moves.Length)
                    {
                        currentMoveID = 0;
                    }
                }
            }
            textblockCubeString.Text = c.CubeString;
        }

        private void btnAuto_Click(object sender, RoutedEventArgs e)
        {
            textblockCubeString.Text = "";
            if (moves.Length != 0)
            {
                if (checkboxAnimation.IsChecked ?? false)
                {
                    autoMoving = true;
                    Rotation t;
                    t = new Rotation(moves[currentMoveID].Trim());
                    currentRotation = t;
                    listboxMoves.SelectedIndex = currentMoveID;
                    int speed = Convert.ToInt32(sliderAnimationSpeed.Value);
                    int stop = Convert.ToInt32(sliderAnimationStop.Value);
                    c3d.Seperate(new Seperation(c3d.Dimension, t));
                    ShowSepertatedCube();
                    c3d.RotateWithAnimation(t, speed, stop);
                }
                else
                {
                    for (int i = 0; i < moves.Length; i++)
                    {
                        Rotation t;
                        t = new Rotation(moves[i].Trim());
                        c.Move(t);
                    }
                    ShowWholeCube();
                }
            }
        }

        private void C3d_AnimationCompleted(Rotation twist)
        {
            c.Move(currentRotation);
            ShowWholeCube();
            if (autoMoving)
            {
                currentMoveID++;
                if (currentMoveID == moves.Length)
                {
                    currentMoveID = 0;
                    //c3d.AnimationCompleted -= C3d_AnimationCompleted;
                    autoMoving = false;
                }
                else
                {
                    Rotation t;
                    t = new Rotation(moves[currentMoveID].Trim());
                    currentRotation = t;
                    listboxMoves.SelectedIndex = currentMoveID;
                    listboxMoves.ScrollIntoView(listboxMoves.SelectedItem);
                    if (checkboxAnimation.IsChecked ?? false)
                    {
                        int speed = Convert.ToInt32(sliderAnimationSpeed.Value);
                        int stop = Convert.ToInt32(sliderAnimationStop.Value);
                        c3d.Seperate(new Seperation(c3d.Dimension, t));
                        ShowSepertatedCube();
                        c3d.RotateWithAnimation(t, speed, stop);
                    }

                }
            }
            else
            {

            }
        }

        private void ShowWholeCube()
        {
            c3d.getWholeCube();
            cw.ClearContent();
            foreach (var item in c3d.WholeCube)
            {
                cw.CubeModel3DGroup.Children.Add(item);
            }
        }

        private void ShowSepertatedCube()
        {
            cw.ClearContent();
            foreach (var item in c3d.RotatablePart)
            {
                cw.CubeModel3DGroup.Children.Add(item);
            }
            foreach (var item in c3d.FixedPart)
            {
                cw.CubeModel3DGroup.Children.Add(item);
            }
        }


    }
}
